<h1>MARS Rover</h1>
<div>
  Photo from the mast camera on one particular day.
</div>
<%
  if ENV.has_key? "NASA"
    nasa_api_key = ENV.fetch("NASA")

    url_rover = "https://api.nasa.gov/mars-photos/api/v1/rovers/curiosity/photos?earth_date=2023-7-22&page=1&sol=1&camera=MAST&api_key=#{nasa_api_key}"
    
    require "http"
    raw_response = HTTP.get(url_rover)

    require "json"
    parsed_response = JSON.parse(raw_response)

    photo = parsed_response["photos"].shuffle
    photo_url = parsed_response["photos"].first["img_src"]
    #p parsed_response["photos"].sample
    p photo_url

%>
  <img src=<%=photo_url%>>
<% else %>
no key
<% end %>
